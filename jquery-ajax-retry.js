// Generated by CoffeeScript 1.3.3
/*
jQuery Ajax retry
https://github.com/cespare/jquery-ajax-retry
Requires jQuery 1.5+; tested with 1.7.2
Compiled with:
  $ coffee -cb jquery-ajax-retry.coffee
*/

(function($) {
  return $.ajaxPrefilter(function(options, originalOptions, jqXhr) {
    options.maxTries = originalOptions.maxTries || 1;
    if (options.tries != null) {
      options.tries += 1;
    } else {
      options.tries = 1;
      options.realError = originalOptions.error;
    }
    return options.error = function(innerJqXhr, textStatus, httpError) {
      if (options.tries < options.maxTries && ((textStatus === "error" && options.retryCodes && options.retryCodes.indexOf(innerJqXhr.status) !== -1) || textStatus === "timeout")) {
        return $.ajax(options);
      } else if (options.realError != null) {
        return options.realError(innerJqXhr, textStatus, httpError);
      }
    };
  });
})(jQuery);
